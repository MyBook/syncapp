<html>
<head>
<meta charset="utf-8">
</head>
<body>
<script src="{{MEDIA_URL}}/audio.min.js"></script>
<script>
  audiojs.events.ready(function() {
    var as = audiojs.createAll();
  });
</script>


<p> Загружено: </p>
<p>content15.html</p>
<p>t_2_i_201610.mp3</p>

<div>
<audio id="track" src="{{ MEDIA_URL }}{{ audio }}" preload="auto" 
ontimeupdate="document.getElementById('tracktime').innerHTML = Math.floor(this.currentTime) + ' / ' + Math.floor(this.duration);"/>
</div>

<p>Current time:</p>
<span id="tracktime">0 / 0</span>


<p>Current text:</p>
<div>сюда вывести xpath найденного фрагмента</div>

<br/>

<p>Text highlight:</p>
<div>
    <input onclick="domRangehighlight('/html/body/div/p[4]');" type="button" value="Найти текст">
  </div>

  <script>
    function domRangehighlight(xpath) {


   	  var iframe = document.getElementsByTagName('iframe')[0];
   	  var iframeDoc = iframe.contentWindow.document;

      
      var root = getElementByXpath(xpath, iframeDoc);
          var rng = iframeDoc.createRange();
          rng.setStart(root, 0);
          rng.setEnd(root, 1);
          var highlightDiv = iframeDoc.createElement('span');
          highlightDiv.style.backgroundColor = 'yellow';
          rng.surroundContents(highlightDiv);
    }

    function getElementByXpath(path, doc) {
  		return doc.evaluate(path, doc, null, XPathResult.FIRST_ORDERED_NODE_TYPE, null).singleNodeValue;
	}
  </script>

 <iframe id="textbook" src="{{ MEDIA_URL }}{{ text }}" width="800" height="600" align="left">

</body>
</html>



{{ audio }}
{{ audio_json }}
{{ map_table }}
{{ text }}